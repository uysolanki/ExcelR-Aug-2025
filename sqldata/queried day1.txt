
create table employee(
eno int(5) primary key auto_increment,
ename varchar(10) not null,
salary int(5) check(salary>=100),
gender varchar(1) check(gender in('m','f')),
dept varchar(10) default 'IT',
city varchar(10) default 'Pune',
workmode varchar(10) check(workmode in('wfo','wfh','hybrid')),
passport varchar(10) unique);

single row:
insert into employee(ename,salary,gender,dept,city,workmode,passport) 
values('Alice',800,'f','Sales','Delhi','wfh','A123456');

multiple row:
insert into employee(ename,salary,gender,dept,city,workmode,passport) 
values
('Roshan',1800,'m','Finance','Delhi','wfh','R123456'),
('Yogesh',1900,'m','Marketing','Mumbai','wfo','Y123456'),
('Sanika',2000,'f','IT','Pune','wfh','S123456'),('Mayuri',210,'f','HR','Mumbai','wfo','M123456'),
('Isha',2200,'f','Sales','Pune','wfh','I123456');

q1) display details of employee working in Delhi
SELECT *
from employee
where city in('Delhi');

q) display names of employee working in Pune or Mumbai
SELECT ename
FROM employee
WHERE city = 'Pune'
OR city = 'Mumbai'

SELECT ename
FROM employee
WHERE city in('Pune','Mumbai');

q) display names of female employee working in Delhi
SELECT ename
FROM employee
WHERE city = 'Delhi'
AND
gender = 'f'

q) display gender wise count of employee
select gender,count(*)
from employee
group by gender

q) display city wise count of employee
select gender,count(*)
from employee
group by gender 

q) display city wise count of employee where more than 2 emps are working
SELECT city, count( * )
FROM employee
GROUP BY city
having count(*)>2;

q) display gender wise max salary
SELECT gender, max( salary )
FROM employee
GROUP BY gender


q) display city wise avg salary
SELECT city, avg( salary ) as 'Average Salary'
FROM employee
GROUP BY city

q)display name of emp earning max salary
select ename
from employee
where salary=(select max(salary) from employee);


q) display names of emps whose sal is > than
the avg sal of females working in pune


relationships
1:1

create table chiefminister(
cmno int(5) primary key,
cmname varchar(10) not null,
cmage int(3) check(cmage>=40));


create table state(
sno int(5) primary key,
sname varchar(10) not null,
capital varchar(10),
cmno int(5) unique,
foreign key(cmno) references chiefminister(cmno));


insert into chiefminister
values
(1,       'Fadnavis',     55),
(2,       'Sharma',       60),
(3,       'Patel',        50 );


insert into state
values
(1,       'Maharasht',     'Mumbai', 1),
(2,       'Rajasthan',     'Jaipur', 2),
(3,       'Gujarat',       'Ahmedabad', 3 );


select cmname as 'Chief Minister'     --using column alias
from state,chiefminister
where
state.cmno=chiefminister.cmno
and
sname = 'Gujarat';


using
inner join (default )

select cmname
from chiefminister 
join
state 
on chiefminister.cmno=state.cmno
where
sname = 'Gujarat';


phase 1 : 
SELECT *
FROM chiefminister
JOIN state ON chiefminister.cmno = state.cmno;

horizontal trimming 
SELECT *
FROM chiefminister
JOIN state ON chiefminister.cmno = state.cmno
WHERE cmage >=52

vertical trimming
SELECT cmname
FROM chiefminister
JOIN state 
ON chiefminister.cmno = state.cmno
WHERE cmage >=52

or using table alias

SELECT cmname
FROM chiefminister cm
JOIN state s
ON cm.cmno = s.cmno
WHERE cmage >=52;


vertical trimming
SELECT cmname
FROM chiefminister
JOIN state 
using cmno
WHERE cmage >=52


1 : M

create table dept(
dno int(5) primary key,
dname varchar(10) not null,
city varchar(10));


create table emp(
eno int(5) primary key,
ename varchar(10) not null,
sal int(5),
dno int(5),
foreign key(dno) references dept(dno));

insert into dept
values
(1,       'IT',     'Pune'),
(2,       'Sales',      'Delhi'),
(3,       'HR',       'Jaipur' );


insert into emp
values
(1,       'Alice',     800, 1),
(2,       'Ben',     900, 1),
(3,       'Chris',     700, 2),
(4,       'David',     500, 2),
(5,       'Elcid',     700, 3);

q) display emp names working in IT dept
select ename
from dept d
join
emp e
using(dno)
where dname like 'IT';

q) display city wise count of emps
select city,count(*) as 'Number of Emps'
from dept d
join
emp e
using(dno)
group by city;


M : M

create table actor(
ano int(5) primary key,
aname varchar(10) not null,
age int(5));


create table movie(
mno int(5) primary key,
mname varchar(10) not null,
ryear int(5));


create table netflix(
ano int(5),
mno int(5),
fees int(5),
foreign key(ano) references actor(ano),
foreign key(mno) references movie(mno));


insert into actor
values
(1,       'SRK',     60),
(2,       'AK',      56),
(3,       'DP',      40 );


insert into movie
values
(1,       'CE',     2010),
(2,       'Dunki',  2024),
(3,       'RR',     2007);

insert into netflix
values
(1,       1,  500),
(1,       2,  1000),
(3,       1,  300),
(2,       3,  400);


q) display movie names of actor SRK

phase 1 :

SELECT *
FROM actor a
JOIN netflix n
USING ( ano )
JOIN movie m
USING ( mno )

phase 2 :  horizontal trimming
SELECT *
FROM actor a
JOIN netflix n
USING ( ano )
JOIN movie m
USING ( mno )
where aname like 'SRK';

phase 3 :  vertical trimming
SELECT mname
FROM actor a
JOIN netflix n
USING ( ano )
JOIN movie m
USING ( mno )
where aname like 'SRK';


q) display acto wise count of movies

phase 1 :

SELECT *
FROM actor a
JOIN netflix n
USING ( ano )
JOIN movie m
USING ( mno )

phase 2 : 
SELECT aname,count(*) as 'Number of Movies done'
FROM actor a
JOIN netflix n
USING ( ano )
JOIN movie m
USING ( mno )
group by aname;


q)  display net worth of all actoes
SELECT aname,sum(fees) as 'Net worth'
FROM actor a
JOIN netflix n
USING ( ano )
JOIN movie m
USING ( mno )
group by aname;

q) display name of actors who have not done any movie (hint : use left join)
phase 1 : 
SELECT * 
FROM actor a
LEFT JOIN netflix n
USING ( ano );

phase 2 :
SELECT *
FROM actor a
LEFT JOIN netflix n
USING ( ano )
WHERE fees IS NULL

phase 3:
SELECT aname
FROM actor a
LEFT JOIN netflix n
USING ( ano )
WHERE fees IS NULL